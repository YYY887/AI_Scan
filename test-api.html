<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è±†åŒ…APIæµ‹è¯•</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
    }
    h1 {
      color: #333;
    }
    .input-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #666;
    }
    input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      box-sizing: border-box;
    }
    button {
      background: #1a73e8;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 15px;
      margin-right: 10px;
    }
    button:hover {
      background: #1557b0;
    }
    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    #result {
      margin-top: 20px;
      padding: 15px;
      border-radius: 4px;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    .success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
  </style>
</head>
<body>
  <h1>ğŸ§ª è±†åŒ…APIæµ‹è¯•å·¥å…·</h1>
  
  <div class="input-group">
    <label for="apiKey">API Key:</label>
    <input type="password" id="apiKey" placeholder="è¾“å…¥ä½ çš„è±†åŒ…API Key">
  </div>
  
  <div class="input-group">
    <label for="modelId">æ¨¡å‹ID:</label>
    <input type="text" id="modelId" value="doubao-seed-1-6-vision-250815">
  </div>
  
  <button id="testUrl" onclick="testWithUrl()">æµ‹è¯•å¤–éƒ¨URLå›¾ç‰‡</button>
  <button id="testBase64" onclick="testWithBase64()">æµ‹è¯•Base64å›¾ç‰‡</button>
  
  <div id="result"></div>
  
  <script>
    // æµ‹è¯•ä½¿ç”¨å¤–éƒ¨URL
    async function testWithUrl() {
      const apiKey = document.getElementById('apiKey').value.trim();
      const modelId = document.getElementById('modelId').value.trim();
      const resultDiv = document.getElementById('result');
      
      if (!apiKey || !modelId) {
        resultDiv.className = 'error';
        resultDiv.textContent = 'è¯·å¡«å†™API Keyå’Œæ¨¡å‹ID';
        return;
      }
      
      resultDiv.className = 'info';
      resultDiv.textContent = 'æ­£åœ¨æµ‹è¯•å¤–éƒ¨URLå›¾ç‰‡...';
      
      try {
        const response = await fetch('https://ark.cn-beijing.volces.com/api/v3/chat/completions', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${apiKey}`
          },
          body: JSON.stringify({
            model: modelId,
            messages: [
              {
                role: 'user',
                content: [
                  {
                    type: 'image_url',
                    image_url: {
                      url: 'https://ark-project.tos-cn-beijing.ivolces.com/images/view.jpeg'
                    }
                  },
                  {
                    type: 'text',
                    text: 'å›¾ç‰‡ä¸»è¦è®²äº†ä»€ä¹ˆ?'
                  }
                ]
              }
            ]
          })
        });
        
        const data = await response.json();
        
        if (response.ok) {
          resultDiv.className = 'success';
          resultDiv.textContent = 'âœ… æµ‹è¯•æˆåŠŸï¼\n\nAPIå“åº”:\n' + JSON.stringify(data, null, 2);
        } else {
          resultDiv.className = 'error';
          resultDiv.textContent = 'âŒ æµ‹è¯•å¤±è´¥\n\né”™è¯¯ä¿¡æ¯:\n' + JSON.stringify(data, null, 2);
        }
      } catch (error) {
        resultDiv.className = 'error';
        resultDiv.textContent = 'âŒ è¯·æ±‚å¤±è´¥\n\né”™è¯¯: ' + error.message;
      }
    }
    
    // æµ‹è¯•ä½¿ç”¨Base64
    async function testWithBase64() {
      const apiKey = document.getElementById('apiKey').value.trim();
      const modelId = document.getElementById('modelId').value.trim();
      const resultDiv = document.getElementById('result');
      
      if (!apiKey || !modelId) {
        resultDiv.className = 'error';
        resultDiv.textContent = 'è¯·å¡«å†™API Keyå’Œæ¨¡å‹ID';
        return;
      }
      
      resultDiv.className = 'info';
      resultDiv.textContent = 'æ­£åœ¨ç”Ÿæˆæµ‹è¯•å›¾ç‰‡...';
      
      // åˆ›å»ºä¸€ä¸ªç®€å•çš„æµ‹è¯•å›¾ç‰‡
      const canvas = document.createElement('canvas');
      canvas.width = 200;
      canvas.height = 100;
      const ctx = canvas.getContext('2d');
      
      // ç»˜åˆ¶èƒŒæ™¯
      ctx.fillStyle = '#4CAF50';
      ctx.fillRect(0, 0, 200, 100);
      
      // ç»˜åˆ¶æ–‡å­—
      ctx.fillStyle = 'white';
      ctx.font = '20px Arial';
      ctx.fillText('æµ‹è¯•å›¾ç‰‡', 50, 55);
      
      // è½¬æ¢ä¸ºbase64
      const base64Image = canvas.toDataURL('image/jpeg', 0.9);
      
      resultDiv.textContent = 'æ­£åœ¨æµ‹è¯•Base64å›¾ç‰‡...';
      
      try {
        const response = await fetch('https://ark.cn-beijing.volces.com/api/v3/chat/completions', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${apiKey}`
          },
          body: JSON.stringify({
            model: modelId,
            messages: [
              {
                role: 'user',
                content: [
                  {
                    type: 'image_url',
                    image_url: {
                      url: base64Image
                    }
                  },
                  {
                    type: 'text',
                    text: 'å›¾ç‰‡ä¸­æœ‰ä»€ä¹ˆå†…å®¹?'
                  }
                ]
              }
            ]
          })
        });
        
        const data = await response.json();
        
        if (response.ok) {
          resultDiv.className = 'success';
          resultDiv.textContent = 'âœ… Base64æµ‹è¯•æˆåŠŸï¼\n\nAPIå“åº”:\n' + JSON.stringify(data, null, 2);
        } else {
          resultDiv.className = 'error';
          resultDiv.textContent = 'âŒ Base64æµ‹è¯•å¤±è´¥\n\né”™è¯¯ä¿¡æ¯:\n' + JSON.stringify(data, null, 2);
        }
      } catch (error) {
        resultDiv.className = 'error';
        resultDiv.textContent = 'âŒ è¯·æ±‚å¤±è´¥\n\né”™è¯¯: ' + error.message;
      }
    }
  </script>
</body>
</html>
